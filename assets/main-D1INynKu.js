import{s as r}from"./supabase-client-BYSCEbDX.js";import"https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";let l="",n="";window.closeModal=function(e){document.getElementById(e).style.display="none",n="",a()};window.showAdminLogin=function(){document.getElementById("adminModal").style.display="flex",setTimeout(()=>document.getElementById("adminUsername").focus(),100)};window.verifyAdmin=async function(){const e=document.getElementById("adminUsername").value.trim(),t=document.getElementById("adminPassword").value.trim(),o=document.getElementById("adminLoginBtn"),i=document.getElementById("adminError");if(!e||!t){s(i,"Kullanıcı adı ve şifre gerekli.");return}o.disabled=!0,o.textContent="Kontrol ediliyor...",i.classList.remove("show");try{const{data:d,error:c}=await r.from("admins").select("*").eq("username",e).eq("password",t).single();d&&!c?(o.textContent="✅ Yönlendiriliyor...",window.location.href="admin-dashboard.html"):(s(i,"❌ Kullanıcı adı veya şifre hatalı!"),o.disabled=!1,o.textContent="Giriş Yap")}catch{s(i,"❌ Bağlantı hatası! Tekrar deneyin."),o.disabled=!1,o.textContent="Giriş Yap"}};document.getElementById("adminPassword").addEventListener("keyup",e=>{e.key==="Enter"&&window.verifyAdmin()});document.getElementById("adminUsername").addEventListener("keyup",e=>{e.key==="Enter"&&document.getElementById("adminPassword").focus()});window.showCashierSelect=function(){document.getElementById("cashierModal").style.display="flex"};window.selectCashier=function(e,t){l=e,n="",a();const o=e.split(" ").map(d=>d[0]).join(""),i=document.getElementById("pinCashierAvatar");i.textContent=o,i.className="cashier-avatar-mini "+t,i.style.cssText="margin:0 auto 12px;width:56px;height:56px;font-size:22px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;",document.getElementById("pinCashierName").textContent=e,document.getElementById("pinError").classList.remove("show"),closeModal("cashierModal"),document.getElementById("pinModal").style.display="flex"};window.pinKeyPress=function(e){n.length>=4||(n+=e,a(),n.length===4&&setTimeout(()=>window.verifyCashier(),120))};window.cancelPin=function(){n.length>0?(n=n.slice(0,-1),a()):(closeModal("pinModal"),document.getElementById("cashierModal").style.display="flex")};function a(){for(let e=0;e<4;e++){const t=document.getElementById("dot"+e);t&&t.classList.toggle("filled",e<n.length)}}window.verifyCashier=async function(){if(n.length!==4)return;const e=document.getElementById("pinError");e.classList.remove("show");try{const{data:t,error:o}=await r.from("cashiers").select("*").eq("name",l).eq("pin",n).single();if(t&&!o)window.location.href=`cashier-dashboard.html?cashier_id=${t.id}`;else{s(e,"❌ PIN hatalı! Tekrar deneyin."),n="",a();const i=document.querySelector("#pinModal .auth-box");i.style.animation="none",i.offsetHeight,i.style.animation="shake .3s ease"}}catch{s(e,"❌ Bağlantı hatası! Tekrar deneyin."),n="",a()}};function s(e,t){e.textContent=t,e.classList.add("show"),setTimeout(()=>e.classList.remove("show"),4e3)}document.querySelectorAll(".auth-modal").forEach(e=>{e.addEventListener("click",t=>{t.target===e&&(e.style.display="none",n="",a())})});
