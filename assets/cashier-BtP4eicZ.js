import{s as h}from"./supabase-client-DN31Znua.js";import"https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";const b=new URLSearchParams(window.location.search),g=b.get("cashier_id");g?v():(f("Kasiyer ID'si bulunamadƒ±. L√ºtfen giri≈ü sayfasƒ±ndan tekrar deneyin."),document.getElementById("loading").style.display="none");async function v(){try{const{data:t,error:a}=await h.from("cashiers").select("*").eq("id",g).single();if(a)throw a;const{data:e,error:r}=await h.from("weekly_performance").select("*").order("total_points",{ascending:!1});if(r)throw r;const{data:n,error:o}=await h.from("entry_history").select("*").eq("cashier_id",g).order("entry_time",{ascending:!1}).limit(10);if(o)throw o;E(t,e,n),document.getElementById("loading").style.display="none",document.getElementById("dashboard").style.display="block"}catch(t){console.error("Dashboard y√ºkleme hatasƒ±:",t),f("Dashboard y√ºklenirken bir hata olu≈ütu: "+t.message),document.getElementById("loading").style.display="none"}}function E(t,a,e){const r={"Tuba Bozaklƒ±":"av-t","Elif Yƒ±ldƒ±rƒ±m":"av-e","Melda Yƒ±lmaz":"av-m","Ceren Erdem":"av-c"},n=t.name.split(" ").map(u=>u[0]).join("");document.getElementById("profileAvatar").textContent=n,document.getElementById("profileAvatar").className="avatar "+(r[t.name]||"av-t"),document.getElementById("profileName").textContent=t.name,document.getElementById("profileRole").textContent=`Kasiyer - ${t.role||"Cafetarya"}`;const o=t.total_points||0;document.getElementById("totalPoints").textContent=o;const i=p(o);document.getElementById("badgeIcon").textContent=i.icon,document.getElementById("badgeLabel").textContent=i.label;const s=B(o);document.getElementById("nextBadge").textContent=s.label;const c=s.threshold-o;document.getElementById("pointsNeeded").textContent=c>0?`${c} puan kaldƒ±`:"Tamamlandƒ±!";const d=s.threshold>0?Math.min(o/s.threshold*100,100):100;document.getElementById("progressFill").style.width=d+"%";const l=a.find(u=>u.cashier_id===t.id)||{};document.getElementById("statEntries").textContent=l.total_entries||0,document.getElementById("statOnTime").textContent=l.on_time_entries||0;const m=l.total_revenue||0;document.getElementById("statRevenue").textContent=y(m),_(a.slice(0,4),t.id),I(e)}function p(t){return t>=500?{icon:"üíé",label:"Elmas"}:t>=300?{icon:"ü•á",label:"Altƒ±n"}:t>=150?{icon:"ü•à",label:"G√ºm√º≈ü"}:t>=50?{icon:"ü•â",label:"Bronz"}:{icon:"üå±",label:"Yeni Ba≈ülayan"}}function B(t){return t>=500?{label:"Maksimum Seviye",threshold:500}:t>=300?{label:"Elmas",threshold:500}:t>=150?{label:"Altƒ±n",threshold:300}:t>=50?{label:"G√ºm√º≈ü",threshold:150}:{label:"Bronz",threshold:50}}function _(t,a){const e=document.getElementById("leaderboard");e.innerHTML="";const r={"Tuba Bozaklƒ±":"av-t","Elif Yƒ±ldƒ±rƒ±m":"av-e","Melda Yƒ±lmaz":"av-m","Ceren Erdem":"av-c"};t.forEach((n,o)=>{const i=o+1,s=n.cashier_id===a,c=n.cashier_name?n.cashier_name.split(" ").map(l=>l[0]).join(""):"??",d=document.createElement("div");d.className="leaderboard-item"+(s?" current":""),d.innerHTML=`
                    <div class="rank rank-${i}">#${i}</div>
                    <div class="leaderboard-avatar ${r[n.cashier_name]||"av-t"}">${c}</div>
                    <div class="leaderboard-info">
                        <div class="leaderboard-name">${n.cashier_name||"Bilinmiyor"}${s?" (Sen)":""}</div>
                        <div class="leaderboard-stats">${n.total_entries||0} giri≈ü ‚Ä¢ ${n.on_time_entries||0} zamanƒ±nda</div>
                    </div>
                    <div class="leaderboard-points">‚≠ê ${n.total_points||0}</div>
                `,e.appendChild(d)})}function I(t){const a=document.getElementById("historyBody");if(a.innerHTML="",t.length===0){a.innerHTML='<tr><td colspan="5" style="text-align: center; color: var(--txt2); padding: 40px">Hen√ºz giri≈ü kaydƒ± yok</td></tr>';return}t.forEach(e=>{const r=document.createElement("tr"),n=new Date(e.entry_time),o=n.toLocaleDateString("tr-TR",{day:"2-digit",month:"short",year:"numeric"}),i=n.toLocaleTimeString("tr-TR",{hour:"2-digit",minute:"2-digit"}),s=e.shift==="sabah"?"Sabah":"√ñƒüle",c=e.shift==="sabah"?"shift-sabah":"shift-ogle",d=e.is_on_time?"‚úÖ":"‚ö†Ô∏è",l=e.is_on_time?"Zamanƒ±nda":"Ge√ß",m=e.is_on_time?"status-ontime":"status-late";r.innerHTML=`
                    <td>
                        <div style="font-weight: 600">${o}</div>
                        <div style="font-size: 12px; color: var(--txt2)">${i}</div>
                    </td>
                    <td><span class="shift-badge ${c}">${s}</span></td>
                    <td><span class="status-badge ${m}">${d} ${l}</span></td>
                    <td class="mono">${y(e.revenue_amount||0)}</td>
                    <td class="mono" style="color: var(--gold)">+${e.points_earned||0}</td>
                `,a.appendChild(r)})}function y(t){return new Intl.NumberFormat("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t)+"‚Ç∫"}function f(t){const a=document.getElementById("error");a.textContent="‚ùå "+t,a.style.display="block"}
